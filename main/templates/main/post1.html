{%load static%}

<!DOCTYPE html>
<html lang="en">
  <head>

    <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />

    <link rel="stylesheet" href="{%static 'main/css/dream.css'%}" >

    <meta charset="UTF-8">
	  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <title>Main</title>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">

  </head>
  <body>
    <header>
      <div class="logo"><a href="main.html"><img src="img/logo.png" alt="Alt"></a></div>
        <nav class="nav-bar">
          <ul>
            <li>
              <a href="about_us.html"><button class="aboutUs-button">About us</button></a>
            </li>
            <li >
              <div class="profile-pic"><a href="profile.html" id="profile-pic"><img src="img/icons8-гость-мужчина-24.png" height="24" width="24"></a></div>
            </li>
          </ul>
        </nav>
      </header>

      <main>
      <div class="dreamInfo">
          <h1 align="center"> {{obj.title}} </h1>     
        <div class="dreamDiscript">
          <p> <img src="img/horror-thumbnail.jpg" width="500" height="300" alt="Иллюстрация" align="right"  vspace="5" hspace="5">Мне опять снился сон….Этот сон…..Каждую ночь одно и тоже. На утро, как обычно, все забудется. Может быть, оно и к лучшему…..
            Останутся только воспоминания о приоткрытых, словно приглашающих, куда-то воротах, рядом с которыми в камне застыли два пионера. А еще странная девочка….Которая постоянно спрашивает;
            - Ты пойдешь со мной?
            - Пойду? Но куда? И зачем? Да и где я вообще нахожусь?
            Конечно, случись все на самом деле, стоило бы непременно испугаться. Как же иначе! Но это всего лишь сон… Тот самый, который я вижу, каждую ночь. А ведь, все это, неспроста! Не обязательно знать где и почему, что бы понять что-то происходит.
            Не что отчаянное, требующего моего внимания. Ведь все окружающее здесь, реально! Реально настолько, насколько реальны вещи в моей квартире; я бы мог открыть ворота, услышать скрип петель, смахнуть рукой осыпающуюся ржавчину, потянуть носом свежий освежающий воздух и поежиться от холода. Мог бы, но для этого надо сдвинуться с места, сделать шаг, пошевелить рукой
            А ведь – это сон, я понимаю, ну что дальше, что изменит мое понимание? Ведь здесь – словно по ту сторону потрескавшегося экрана старого телевизора, который из последних сил борется с помехами и силится показать зрителям все, не упустив не малейшей детали. Но вот картинка теряет четкость. Наверное, скоро просыпаться.
            - Может быть, спросить у нее что? У девочки.
            Как же ее зовут…Например про звезды…Хотя почему про звезды? Можно же спросить у нее про ворота! Да, про ворота! Вот она удивиться. Или лучше про букву ё. Хорошая была буква. Как будто ее больше нет. И какое отношение буквы, ворота и звезды имеют к этому месту?
            Ведь если каждую ночь снится этот сон, который потом все равно забудется, надо искать разгадку здесь и сейчас!
            А вот, если присмотреться, можно увидеть Магелланово облако…Словно попал в южное полушарие! Во сне всегда больше волнуют мелочи; не естественный цвет травы, невозможная кривизна прямых или свое перекошенное отображение – реальная опасность, готовая оборвать все здесь и сейчас, кажется пустяком. Естественно, ведь здесь, нельзя умереть. Я точно знаю - я это делал сотни раз. Но если нельзя умереть, нет смысла жить?
            Надо спросить у девочки: она местная должна знать! Да, именно! Спросить, например, про сову. Больно уж птица странная…А впрочем, неважно…
            - Ты пойдешь со мной? – И каждый раз надо отвечать. Иначе не как, иначе сон не закончиться, а я – не проснусь.
            - Да я пойду с тобой – Каждый раз так сложно решить, что же ответить. Где я, что я здесь делаю, кто она такая? И почему от ответа на этот вопрос зависит так много в моей жизни? Или не зависит? Ведь это просто сон…Просто сон…"</p>
        </div>
        
      </main>
  </body>

  {%block scripts %}
    <script>
        $( document ).ready(function() {

            $('.like-form').submit(function(e){
                e.preventDefault()
                
                const post_id = $(this).attr('id')
                
                const likeText = $(`.like-btn${post_id}`).text()
                const trim = $.trim(likeText)
                
                const url = $(this).attr('action')
                
                let res;
                const likes = $(`.like-count${post_id}`).text()
                const trimCount = parseInt(likes)
                
                $.ajax({
                    type: 'POST',
                    url: url,
                    data: {
                        'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                        'post_id':post_id,
                    },
                    success: function(response) {
                        if(trim === 'Unlike') {
                            $(`.like-btn${post_id}`).text('Like')
                            res = trimCount - 1
                        } else {
                            $(`.like-btn${post_id}`).text('Unlike')
                            res = trimCount + 1
                        }

                        $(`.like-count${post_id}`).text(res)
                    },
                    error: function(response) {
                        console.log('error', response)
                    }
                })
            })

        });
    </script>
  {%endblock scripts%}

</html>